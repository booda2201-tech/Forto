
<!-- <nav class="navbar navbar-expand-lg navbar-light shadow-sm">
  <div class="container-fluid navbar-width position-relative">
    <a routerlink="/" class="navbar-brand" href="/">
      <img src="" alt="Logo" class="logo"></a>

    <div id="navbarSupportedContent"
    class="collapse navbar-collapse justify-content-between">
    <ul class="navbar-nav mx-auto mb-2 mb-lg-0 px-0">
      <li class="nav-item mx-3">
        <a routerlink="/home"
          routerlinkactive="active"
          class="nav-link active" href="/home"></a>
      </li>
    </ul>
    <ul class="navbar-nav d-flex gap-1 flex-row justify-content-around align-items-center px-0">
      <li class="nav-item pointer">
        <a routerlink=""
          routerlinkactive=""
          class="nav-link" href=""> عمل طلب </a>
      </li>
    <li class="nav-item mx-3">
        <a routerlink="/home"
          routerlinkactive="active"
          class="nav-link active" href="/home">طلبات المستخدم</a>
      </li>
    </ul>
  </div>
</div>
</nav> -->

<!-- <nav class="navbar">
  <div class="container">
<div class="checkbtn" (click)="toggleMenu()">
      <span>☰</span>
    </div>
    <div class="logo" routerLink="/">
      <img src="../../../assets/imeg/logo forto.png" alt="#"> </div>

<ul class="nav-links" [class.active]="isMenuOpen">
          <li><a href="#" routerLinkActive="active-link" routerLink="/requests"> الطلبات </a></li>
          <li><a href="#" routerLinkActive="active-link" routerLink="/create-order">اطلب هنا </a></li>
    </ul>

  </div>
</nav> -->


<nav class="navbar" dir="rtl">
  <div class="container">
    <div class="checkbtn" (click)="toggleMenu()" *ngIf="userRole$ | async">
        <span>☰</span>
      </div>

    <div class="logo" [routerLink]="getLogoRoute()">
      <img src="../../../assets/imeg/logo forto.png" alt="Forto Logo">
    </div>

    <div class="overlay" *ngIf="isMenuOpen" (click)="toggleMenu()"></div>

    <ul class="nav-links" [class.active]="isMenuOpen" *ngIf="{ role: userRole$ | async, activeShift: activeShift$ | async } as data">

      <li class="welcome-msg" style="color: #4a4a4a; padding: 0 15px; font-weight: bold;">
          مرحباً، {{ getDisplayName() }}
      </li>

      <ng-container *ngIf="data.role === 'admin'">
        <li>
          <a routerLink="/admin/services"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{exact: true}"
              (click)="isMenuOpen = false"> الرئيسية </a>
        </li>
      </ng-container>


      <ng-container *ngIf="data.role === 'cashier'">
        <li>
          <a routerLink="/cashier/new-reservation"
              routerLinkActive="active-link"
              [routerLinkActiveOptions]="{exact: true}"
              (click)="isMenuOpen = false"> الرئيسية </a>
        </li>
        <li>
          <a href="#" (click)="openTipsModal($event)" style="cursor: pointer;">إضافة مبالغ أخرى</a>
        </li>
        <li *ngIf="data.activeShift">
          <a href="#" (click)="endShift($event)" style="cursor: pointer; color: #e65100; font-weight: bold;" [class.disabled]="endingShift">
            {{ endingShift ? 'جاري إنهاء الوردية...' : 'إنهاء الوردية' }}
          </a>
        </li>
      </ng-container>


      <ng-container *ngIf="data.role === 'worker'">
        <li><a routerLink="/worker-page" routerLinkActive="active-link"(click)="isMenuOpen = false" >مهامي</a></li>

      </ng-container>

         <li *ngIf="data.role">
        <a (click)="logout()" style="cursor: pointer; color: #ff4d4d; font-weight: bold;">تسجيل الخروج
        </a>
      </li>
      <li *ngIf="!data.role">
        <a routerLink="/login"(click)="isMenuOpen = false">تسجيل الدخول</a>
      </li>
    </ul>
  </div>
</nav>

<!-- مودال إضافة مبالغ أخرى (للکاشیر فقط) -->
<div class="modal fade" id="tipsModal" tabindex="-1" aria-hidden="true" dir="rtl">
  <div class="modal-dialog modal-dialog-centered" style="max-width: 380px;">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold">إضافة مبالغ أخرى</h5>
        <!-- <button type="button" class="btn-close" (click)="closeTipsModal()" aria-label="إغلاق"></button> -->
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label fw-bold">التاريخ</label>
          <input type="date" class="form-control" [(ngModel)]="tipsDate" />
        </div>
        <div class="mb-3">
          <label class="form-label fw-bold">المبلغ (ج.م)</label>
          <input type="number" class="form-control" [(ngModel)]="tipsAmount" min="0" step="0.01" placeholder="0" />
        </div>
      </div>
      <div class="modal-footer border-0">
        <button type="button" class="btn btn-outline-secondary rounded-3" (click)="closeTipsModal()">إلغاء</button>
        <button type="button" class="btn btn-orange text-white rounded-3 fw-bold" (click)="saveTips()"
          [disabled]="savingTips || (tipsAmount !== null && tipsAmount !== undefined && tipsAmount < 0)">
          <span *ngIf="!savingTips">حفظ</span>
          <span *ngIf="savingTips">جاري الحفظ...</span>
        </button>
      </div>
    </div>
  </div>
</div>

